class DataLayer{constructor(){this.eventStore=[],this.callback={},this.data={}}on(t,a){"function"==typeof a&&(this.callback[t]||(this.callback[t]=[]),this.callback[t].push(a))}off(t){if("function"!=typeof t)return;const a=this.callback;Object.keys(a).forEach(e=>{this.callback[e]=a[e].filter(a=>a!==t)})}emit(t,a){(this.callback[t]||[]).forEach(t=>{t.call(null,a)})}update(t,a){const e=this.data||{};a.timestamp=(new Date).getTime(),Object.keys(a).forEach(t=>{const s=a[t];this.isDefined(s)&&(e[t]=s)}),this.eventStore.push({eventName:t,eventData:a}),this.data=e,this.emit(t,a)}snapshot(){return this.data}clear(){this.data={},this.eventStore=[]}isDefined(t){return!(void 0===t||"undefined"===t||null===t||""===t)}}
